---
title: "Analyse du trafic VéloMagg à Montpellier"
author: "   "
format: html
execute:
  echo: true  # Affiche le code
  output: true  # Affiche les résultats du code
---


## Chargement des données et traitement initial

```{python}
import pandas as pd
import geopandas as gpd
import matplotlib.pyplot as plt
from shapely.geometry import Point
import plotly.express as px

# Charger les données des compteurs
compteurs_df = pd.read_csv(r"C:\Users\Clara\Desktop\dossier projet\MMM_MMM_GeolocCompteurs.csv")

# Charger les données des quartiers
quartiers_gdf = gpd.read_file(r"C:\Users\Clara\Desktop\dossier projet\VilleMTP_MTP_Quartiers.json")


# Convertir les latitudes et longitudes en géométrie de points
compteurs_gdf = gpd.GeoDataFrame(compteurs_df, 
                                  geometry=[Point(xy) for xy in zip(compteurs_df['Longitude'], compteurs_df['Latitude'])],
                                  crs="EPSG:4326")
# Reprojection des données des quartiers en EPSG:4326 (si nécessaire)
quartiers_gdf = quartiers_gdf.to_crs("EPSG:4326")

# Joindre les compteurs aux quartiers
compteurs_with_quartier = gpd.sjoin(compteurs_gdf, quartiers_gdf, how="left", predicate="within")

#calculer le volume de traffic par quartier
traffic_by_quartier=compteurs_with_quartier.groupby('name').size().reset_index(name='Volume de traffic')
print("colonne")
print(traffic_by_quartier.columns)
```
